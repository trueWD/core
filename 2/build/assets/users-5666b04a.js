import{L as T,P as V}from"./page-header-e847031b.js";import{_ as Y,S as D,r as C,a as E,j as F,b as d,l as u,w as e,e as w,o as n,d as s,f as l,c as f,m as _,h as a,g as A,t as g,F as S}from"../js/app2.js";import{C as H}from"./create_user-e0d04e7a.js";import{i as p}from"./index-766558cd.js";const K={name:"usersList",components:{Layout:T,PageHeader:V,CreateUser:H},setup(){const{newAxios:i}=D(),y=C("Kullanıcı Yönetimi"),U=C([{text:"ANASAYFA",href:"/"},{text:"KULLANICI YÖNETİMİ",active:!0}]),t=E(),v=C([]);F(()=>{k()});const k=async()=>{let c=await i.get("/admin/users/list");v.value=c.data};return{title:y,items:U,getUsersList:k,userList:v,loginAs:async c=>{await i.post("/admin/users/login_as",{id:c}).then(r=>{if(r.data.type=="error")return p.warning(r.data.text,{autoClose:1e3}),!1;p.success(r.data.text,{autoClose:1e3}),setTimeout(function(){t.user=r.data.user,w.push({name:"Users"})},1e3)}).catch(r=>{p.success("Server error 2002",{autoClose:1e3})})},store:t,leaveUser:async c=>{await i.post("/admin/users/leave_user",{id:c}).then(r=>{if(r.data.type=="error")return p.warning(r.data.text,{autoClose:1e3}),!1;p.success(r.data.text,{autoClose:1e3}),setTimeout(function(){t.user=r.data.user,w.push({name:"Users"})},1e3)}).catch(r=>{p.success("Server error 2002",{autoClose:1e3})})}}}},j={class:"row"},G={class:"col-12"},R={class:"card"},z=l("div",{class:"card-header"},[l("h6",{class:"card-title mb-0"},"Kullanıcı Listesi")],-1),q={class:"card-body"},J={class:"d-flex gap-2 align-items-center"},O={class:"flex-shrink-0"},Q=["src"],W={class:"flex-grow-1"},X={href:"#"},Z=l("i",{class:"ri-checkbox-circle-line fs-xl align-middle"},null,-1),$=["onClick"],ee=l("i",{class:"bi bi-login"},null,-1),te=["onClick"],se=l("i",{class:"bi bi-login"},null,-1),ae=["onClick"],oe=l("i",{class:"bi bi-login"},null,-1);function ne(i,y,U,t,v,k){const L=d("PageHeader"),x=d("CreateUser"),c=d("b-th"),r=d("b-tr"),N=d("b-thead"),I=d("b-link"),b=d("b-td"),h=d("b-badge"),B=d("b-tbody"),M=d("b-table-simple"),P=d("Layout");return n(),u(P,null,{default:e(()=>[s(L,{title:t.title,items:t.items},null,8,["title","items"]),s(x,{onGetUsersList:t.getUsersList,ref:"createUser"},null,8,["onGetUsersList"]),l("div",j,[l("div",G,[l("div",R,[z,l("div",q,[i.$can(["create user"])?(n(),f("button",{key:0,onClick:y[0]||(y[0]=o=>i.$refs.createUser.getUserInfo()),type:"button",class:"btn btn-success mb-2","data-bs-toggle":"modal","data-bs-target":"#CreateUserModal"},"Create User")):_("",!0),i.$can(["user management"])?(n(),u(M,{key:1,responsive:"",class:"align-middle table-nowrap mb-0"},{default:e(()=>[s(N,{class:"table-light"},{default:e(()=>[s(r,null,{default:e(()=>[s(c,{scope:"col"},{default:e(()=>[a("ID")]),_:1}),s(c,{scope:"col"},{default:e(()=>[a("Name")]),_:1}),s(c,{scope:"col"},{default:e(()=>[a("Email")]),_:1}),s(c,{scope:"col"},{default:e(()=>[a("Roles")]),_:1}),s(c,{scope:"col"},{default:e(()=>[a("Register Date")]),_:1}),s(c,{scope:"col"},{default:e(()=>[a("Status")]),_:1}),s(c,{scope:"col"},{default:e(()=>[a("Login")]),_:1})]),_:1})]),_:1}),s(B,null,{default:e(()=>[(n(!0),f(S,null,A(t.userList,o=>(n(),u(r,null,{default:e(()=>[s(b,null,{default:e(()=>[s(I,{onClick:m=>i.$refs.createUser.getUserInfo(o.id),"data-bs-toggle":"modal","data-bs-target":"#CreateUserModal",class:"fw-medium"},{default:e(()=>[a("#"+g(o.id),1)]),_:2},1032,["onClick"])]),_:2},1024),s(b,null,{default:e(()=>[l("div",J,[l("div",O,[l("img",{src:"/build/images/avatar-3.jpg",alt:"",class:"avatar-xs rounded-circle"},null,8,Q)]),l("div",W,[a(g(o.name)+" ",1),o.id===t.store.user.id&&t.store.user.impersonated_by===null?(n(),u(h,{key:0,class:"bg-danger"},{default:e(()=>[a(" You")]),_:1})):_("",!0),o.id===t.store.user.impersonated_by?(n(),u(h,{key:1,class:"bg-danger"},{default:e(()=>[a(" Siz")]),_:1})):_("",!0),o.id===t.store.user.id?(n(),u(h,{key:2,class:"bg-success"},{default:e(()=>[a("Connected")]),_:1})):_("",!0)])])]),_:2},1024),s(b,null,{default:e(()=>[a(g(o.email),1)]),_:2},1024),s(b,null,{default:e(()=>[(n(!0),f(S,null,A(o==null?void 0:o.roles,m=>(n(),f("span",null,[l("a",X,[m.name=="root"?(n(),u(h,{key:0,variant:"success-subtle",class:"text-danger badge-border m-1"},{default:e(()=>[a(g(m.name),1)]),_:2},1024)):(n(),u(h,{key:1,variant:"danger-subtle",class:"text-success badge-border m-1"},{default:e(()=>[a(g(m.name),1)]),_:2},1024))])]))),256))]),_:2},1024),s(b,null,{default:e(()=>[a(g(o.created_at),1)]),_:2},1024),s(b,{class:"text-success"},{default:e(()=>[Z,a(" Active ")]),_:1}),s(b,null,{default:e(()=>[o.id===t.store.user.id&&t.store.user.impersonated_by!=null?(n(),f("button",{key:0,type:"button",class:"btn btn-danger btn-sm",onClick:m=>t.leaveUser(o.id)},[ee,a("Logout ")],8,$)):_("",!0),o.id!==t.store.user.id&&o.id!==t.store.user.impersonated_by?(n(),f("button",{key:1,type:"button",class:"btn btn-primary btn-sm",onClick:m=>t.loginAs(o.id)},[se,a("Login As ")],8,te)):_("",!0),o.id===t.store.user.impersonated_by?(n(),f("button",{key:2,type:"button",class:"btn btn-warning btn-sm",onClick:m=>t.leaveUser(o.id)},[oe,a("Back to my account ")],8,ae)):_("",!0)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})):_("",!0)])])])])]),_:1})}const ie=Y(K,[["render",ne]]);export{ie as default};
